SELECT *  

FROM dbo.master; 

  

ALTER TABLE suicidedeaths 

DROP COLUMN F7,F8; 

  

--Finding the number of suicide deaths in each country per year; 

SELECT country, year, COUNT (suicides_no) AS suicide_count 

FROM master 

GROUP BY country,year 

ORDER BY country; 

  

  

--Finding the number of suicide deaths in each country ; 

SELECT country, COUNT (suicides_no) AS suicide_count 

FROM dbo.master  

GROUP BY country 

ORDER BY country; 

  

--Finding the number of suicide deaths each year ; 

SELECT year, COUNT (suicides_no) 

FROM dbo.master 

GROUP BY year 

ORDER BY year; 

  

--Finding the year with maximum suicide count 

SELECT year, MAX (suicides_no) AS maximum_suicides 

FROM dbo.master 

GROUP BY year 

ORDER BY maximum_suicides; 

  

--Finding suicide count according to gender 

  

SELECT country, sex, COUNT (suicides_no) As gender_suicide_count 

FROM dbo.master 

GROUP BY country,sex 

ORDER BY country; 

  

--Finding suicide count based on age group 

SELECT country,age , COUNT (suicides_no) AS age_group_suicides 

FROM dbo.master 

GROUP BY country , age 

ORDER BY country; 

  

--Gender based suicide count across the globe 

SELECT sex, COUNT (suicides_no) As gender_suicide_count 

FROM dbo.master 

GROUP BY sex 

ORDER BY sex; 

--USING CTE TO FIND OUT THE SUICIDE PERCENTAGE 

WITH Suicide_int (country,year ,total_suicides) 

AS 

(SELECT distinct 

country,year,SUM(CONVERT(int,suicides_no)) OVER (PARTITION BY country,year ORDER BY country,year asc) AS total_suicides 

FROM dbo.master), 

 pop_int (country,year, total_pop) 

AS 

(SELECT distinct country,year,SUM (convert (bigint, population))OVER (PARTITION BY country,year ORDER BY country,year asc) AS total_pop 

FROM dbo.master) 

  

SELECT convert(decimal(10,3), total_suicides)/convert(decimal(38,5), total_pop)*100 as suicide_percentage, pop_int.country,Suicide_int.total_suicides,pop_int.total_pop,pop_int.year 

FROM pop_int  , Suicide_int  

where pop_int.country = Suicide_int.country and pop_int.year = Suicide_int.year order by pop_int.country ,pop_int.year 
